shannon.entropy <- function(p)
{
if (min(p) < 0 || sum(p) <= 0)
return(NA)
p.norm <- p[p>0]/sum(p)
-sum(log(p.norm)*p.norm)
}
library(Biostrings)
res=readAAMultipleAlignment("suplementary data 1.fa")
ent=apply(res,2,function(x) shannon.entropy(table(x)))
res
res=as.matrix(aa_align)
res=as.matrix(res)
ent=apply(res,2,function(x) shannon.entropy(table(x)))
positions_mutations:
ent
ent
reference=read.csv("./TableS7.csv",skip=1)
reference
View(reference)
wilcox.test(reference$Enterovirus.B.Entropy~reference$X)
reference=read.csv("./TableS7.csv",skip=1)
wilcox.test(reference$Enterovirus.B.Entropy~reference$Mutated)
reference$Enterovirus.B.Entropy~reference$Mutated
table(reference$Mutated)
reference=read.csv("./TableS7.csv",skip=1)
wilcox.test(reference$Enterovirus.B.Entropy~reference$Mutated)
table(reference$SS_class[reference$Mutated==1])
table(reference$structural_position[reference$Mutated==1])
## read reference information and mutant information
reference=read.csv("./TableS7.csv",skip=1)
## test for variability
wilcox.test(reference$Enterovirus.B.Entropy~reference$Mutated)
wilcox.test(reference$Enterovirus.B.Entropy~reference$Mutated.in.2.lines)
table(reference$SS_class[reference$Mutated.in.2.lines==1])
## read reference information and mutant information
reference=read.csv("./TableS7.csv",skip=1)
## test for variability
wilcox.test(reference$Enterovirus.B.Entropy~reference$Mutated)
wilcox.test(reference$Enterovirus.B.Entropy~reference$Mutated.in.2.lines)
# information on structural features
table(reference$SS_class[reference$Mutated==1])
table(reference$SS_class[reference$Mutated.in.2.lines==1])
table(reference$structural_position[reference$Mutated.in.2.lines==1])
## read reference information and mutant information
reference=read.csv("./Table S7.csv",skip=1)
